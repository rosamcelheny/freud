<!DOCTYPE HTML>
<html>
	
	<head>
		<title>Wolf Man Dream</title>
		<!-- General stylesheet - include for each one -->
		<link rel="stylesheet" href="css/shared.css" type="text/css" media="screen" />
		<!-- styles for this page -->
		<link rel="stylesheet" href="css/wolf-man.css" type="text/css" media="screen" />
		<!-- jquery library -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
		<!-- zoomooz library -->
		<script type="text/javascript" src="js/jquery.zoomooz.min.js"></script>
	</head>

	<body>
		<div class='container'>
		    <div class="zoomViewport">
				<div id="container" class="zoomContainer">
					<!-- these divs are the clickable parts of the drawing. make sure that the data-index of the zoomTarget matches the data-index of the caption. Also, the next/previous buttons go in order.
					note: add 'data-debug=true' if you want the red boxes to appear for debugging. -->
	        <div class="zoomTarget" data-index="1"></div>
					<div class="zoomTarget" data-index="2"></div>
					<div class="zoomTarget" data-index="3"></div>
					<div class="zoomTarget" data-index="4"></div>
					<!-- drawing goes here -->
          <img id="drawing" src="images/wolf-man-dream.jpg">	    
				</div>
		    </div>
		</div>
		<div class="sidebar">
			<div class='caption'>
				<div class='title'>
					<h1>Sergei Pankejeff</h1>
					<h2>Wolf Man Dream</h2>	
				</div>
			</div>
			<div class="caption" data-index="1">
				<p>I dreamt that it was night and that I was lying in bed. (My bed stood with its foot towards the window; in front of the window there was a row of old walnut trees. I know it was winter when I had the dream, and night-time.)</p>
			</div>
			<div class="caption" data-index="2">
				<p>Suddenly the window opened of its own accord, and I was terrified to see that some white wolves were sitting on the big walnut tree in front of the window.</p>
			</div>
			<div class="caption" data-index="3">
				<p>There were six or seven of them. The wolves were quite white, and looked more like foxes or sheep-dogs, for they had big tails like foxes and they had their ears pricked like dogs when they pay attention to something.</p>
			</div>
			<div class="caption" data-index="4">
				<p>In great terror, evidently of being eaten up by the wolves, I screamed and woke up. My nurse hurried to my bed, to see what had happened to me. It took quite a long while before I was convinced that it had only been a dream; I had had such a clear and life-like picture of the window opening and the wolves sitting on the tree. At last I grew quieter, felt as though I had escaped from some danger, and went to sleep again.</p>
			</div>
			<!-- just got rid of the navigation for now. -->
			<!-- <div id="navigation">
				<div id="prev" class="zoomButton" data-type="prev" data-root=".zoomViewport">&lt;</div>
				<div id="next" class="zoomButton" data-type="next" data-root=".zoomViewport">&gt;</div>
			</div> -->
			
	
		<!-- put in a link to get out of interactive  -->		
			<center><div id="link">	<a href="https://scholar.harvard.edu/agriswold/freud-interactives">Return</a></center>
		    </div>	</center>		
			
			
			
			
		</div>   
	</body>
	<script>

		// declare some variables
		var width;
		var height;
		var caption;

		// This function makes the zoom viewport the same size as the drawing. It also calculates the height of the window, which we'll use when we're detecting the scroll.
		function size() {
			width = $("#drawing").width();
			height = $("#drawing").height();
			console.log("width =" + width);
			console.log("height =" + height);

			$('.zoomViewport').height(height);
			$('.zoomViewport').width(width);
		}

		// and whenever the window is resized.
		$(window).resize(function(){
			size();
			getValues();
		});

		// make an array with the position of the top and bottom of each caption div.
		var values = [];
		function getValues() {
			$('.caption').each(function(i) {
				var pTop = $(this).offset().top;
				var pBottom = $(this).height() + pTop;
				console.log(i +" pTop= "+ pTop+" pBot= "+pBottom);
				values.push({pTop, pBottom});
			});
		}

		// figre out which caption is the one you're in, by comparing how far you've scrolled down the page to the values in the array created by getValues.
		function getCaption(scrollY) {
			var indexToReturn = 0;
			for (i = 0; i < values.length; i++) {
				if (scrollY >= values[i].pTop && scrollY < values[i].pBottom){
					// console.log(i);
					indexToReturn = i;
				}
			}
			return indexToReturn;
		}
		
		function setupScrollEvents() {
			// when the sidebar scrolls, figure out which caption it is and trigger a click on that zoom target.
			$('.sidebar').scroll(function() {
				// calculate the amount you've scrolled down the page
				var scroll_amt = $(this).scrollTop()+ $(this).offset().top
				console.log(scroll_amt);
				// pass that to the getCaption variable
				caption = getCaption(scroll_amt);
				console.log(caption);

				// now, simulate clicking on the right zoomTarget. If you're back to the beginning, click to zoom out.
				if (caption == 0) {
					$('.zoomViewport').trigger("click");
				} else {
					$('.zoomTarget[data-index="' + caption + '"]').trigger("click");
				}
			});
		}

		// do these things when the page loads.
		$(document).ready(function(){
			size();
			getValues();
			setupScrollEvents();
		});

	</script>
</html>
	